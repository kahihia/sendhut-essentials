{% load lunch_extras %}
{% load thumbnail %}

<div class="cart" id="cart-confirm">
  {% if grouped_cart %}
    <h2 class="text-center bold">Your Order</h2>
    {% if grouped_cart|length > 1 %}
      <h6 class="text-center">You have have added food from {{grouped_cart|length}} restaurants</h6>
    {% endif %}

    <div>
      {% for vendor_name, subcart in grouped_cart %}
        <h5 class="subcart-header">{{ vendor_name }}</h5>
        {% for line in subcart %}
          <div class="container-fluid cart-line">
            <div class="row">
              <div class="col-sm-1">{{line.quantity}}</div>
              <div class="col-sm-10">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-sm-10">
                      <a class="item-popup"
                         data-href="{% url 'lunch:cartline_detail' uuid=line.uuid slug=line.slug %}">
                         {{ line.name }}
                         <ul class="text-muted">
                           {% for x in line.extras_meta %}
                             <li>{{x.name}}</li>
                           {% endfor %}
                         </ul>
                      </a>
                    </div>
                    <div class="col-sm-1">{{ line.total }}
                      <a data-href="{% url 'lunch:cartline_delete' line.uuid %}" href="#" class="x-delete">
                        Remove
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
        <div class="container cart-summary">
          <div class="row">
            <div class="col-sm-3 offset-sm-7"><a>Subtotal</a></div>
            <div class="col-sm-1"><a>{{ subcart|subcart_total }}</a></div>
          </div>
          <div class="row">
            <div class="col-sm-3 offset-sm-7"><a>Delivery</a></div>
            <div class="col-sm-1"><a>{{ delivery_fee }}</a></div>
          </div>
        </div><!--// cart cost -->
        <br>
      {% endfor %}
    </div>

    <div class="container cart-summary">
      <div class="row">
        <div class="col-sm offset-sm-7"><h5 class="bold">Total</h5></div>
        <div class="offset-sm-2 col-sm-2 bold">{{ total }}</div>
      </div>
    </div><!-- // cart-summary  -->

    <div class="col-sm-5 offset-sm-7">
      <hr>
      <form id="delivery-time-form" action="{% url 'lunch:checkout' %}" method="POST">
        {% csrf_token %}
        <div class="form-group row">
          <label for="delivery_address" class="col-sm-4 col-form-label">Delivery Address</label>
          <div class="col-sm-8">
            <input type="text" class="form-control" name="delivery_address" placeholder="Enter location or landmark">
          </div>
        </div>
        <div class="form-group row">
          <label class="col-sm-4 col-form-label" for="delivery-time">Delivery Time</label>
          <div class="col-sm-8">
            <select class="mb-3 mr-sm-3 form-control-sm" id="delivery_time">
              <option value="11:30">11:30</option>
              <option value="12:00">12:00</option>
              <option value="12:30">12:30</option>
              <option value="1:30">1:30</option>
              <option value="2:00">2:00</option>
              <option value="2:30">2:30</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <label for="instructions">Special instructions</label>
          <textarea class="form-control" rows="3"
                    name="notes"
                    placeholder="Delivery Instructions. Ex. Call me when youâ€™re outside!"></textarea>
        </div>
        <br>
        <button type="submit" class="btn btn-primary">Submit order</button>
      </form>
    </div> <!--// checkout -->

  {% else %}
    <div class="clearfix"></div>
    <div class="col-sm-5 offset-sm-4 empty-cart-msg"><h2 class="text-muted empmsg">Your basket is empty</h2></div>
  {% endif %}
</div>
